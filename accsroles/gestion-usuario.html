<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion de Usuario</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css" />
    <link href="assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css" />
    <link href="assets/css/style.css" rel="stylesheet">
     <style>
        .texto-color{
            color: #1034a6 !important;
        }
    </style>
</head>
<body class="bg-info">
    <section class="p-5 bg-light shadow">
        <h3 class="text-dark">Gesti√≥n de Usuarios</h3>
        
        <div class="d-flex justify-content-between mb-3 align-items-center">
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalCrearUsuario"><i class="fas fa-user-plus me-2"></i> Crear Nuevo Usuario</button>
            <input type="search" class="form-control w-50" placeholder="Buscar por nombre, email o ID...">
        </div>
        
        <div class="table-responsive">
            <table class="table table-bordered table-hover align-middle">
                <thead class="table-secondary">
                    <tr>
                        <th>ID</th> 
                        <th>Nombre Completo</th>
                        <th>Email</th>
                        <th>Rol</th>
                        <th>Acciones</th>
                    </tr>
                </thead>

                <tbody>
                    <tr>
                        <td>1001</td>
                        <td>Valeria Gomez</td>
                        <td>valeria@hospital.com</td>
                        <td><span class="badge bg-danger">Administrador</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary" 
                                title="Editar Datos"
                                data-bs-toggle="modal" 
                                data-bs-target="#modalEditarUsuario">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-warning" 
                                title="Restablecer Contrase√±a"
                                data-id-usuario="1001" 
                                onclick="restablecerContrasena(this.getAttribute('data-id-usuario'))">
                                <i class="fas fa-key"></i>
                            </button>
                        </td>
                    </tr>

                </tbody>
            </table>

        </div>
        
        <div class="d-flex justify-content-end mt-4">
            <nav aria-label="Page navigation example">
                <ul class="pagination">
                    <li class="page-item disabled"><a class="page-link" href="#">Anterior</a></li>
                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                    <li class="page-item"><a class="page-link" href="#">Siguiente</a></li>
                </ul>
            </nav>
        </div>

    </section>
    
    <div class="modal fade" id="modalCrearUsuario" tabindex="-1" aria-labelledby="crearUsuarioLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg"> <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="crearUsuarioLabel"><i class="fas fa-user-plus me-2"></i> Registrar Nuevo Usuario</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            
            <form id="formCrearUsuario">
                <div class="modal-body">
                    
                    <h6 class="mb-3 texto-color">Informaci√≥n B√°sica</h6>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="nombreUsuario" class="form-label">Nombre Completo</label>
                            <input type="text" class="form-control" id="nombreUsuario" required>
                        </div>
                        <div class="col-md-6">
                            <label for="cedulaUsuario" class="form-label">ID / C√©dula</label>
                            <input type="text" class="form-control" id="cedulaUsuario" required>
                        </div>
                    </div>

                    <h6 class="mb-3 texto-color">Datos de Acceso</h6>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="emailUsuario" class="form-label">Email</label>
                            <input type="email" class="form-control" id="emailUsuario" required>
                        </div>
                        <div class="col-md-6">
                            <label for="passwordUsuario" class="form-label">Contrase√±a Temporal</label>
                            <input type="password" class="form-control" id="passwordUsuario" placeholder="Se recomienda una temporal" required>
                        </div>
                    </div>

                    <h6 class="mb-3 texto-color">Asignaci√≥n de Rol</h6>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="rolUsuario" class="form-label">Rol</label>
                            <select class="form-select" id="rolUsuario" required>
                                <option value="" selected disabled>Selecciona un rol</option>
                                <option value="paciente">Paciente</option>
                                <option value="medico">M√©dico</option>
                                <option value="admin">Administrador</option>
                            </select>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-success"><i class="fas fa-save me-2"></i> Guardar Usuario</button>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="modal fade" id="modalEditarUsuario" tabindex="-1" aria-labelledby="editarUsuarioLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="editarUsuarioLabel"><i class="fas fa-edit me-2"></i> Editar Datos de Usuario</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            
            <form id="formEditarUsuario">
                <div class="modal-body">
                    <input type="hidden" id="editUsuarioId" name="usuario_id"> 
                    
                    <h6 class="mb-3 text-primary">Informaci√≥n B√°sica</h6>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="editNombreUsuario" class="form-label">Nombre Completo</label>
                            <input type="text" class="form-control" id="editNombreUsuario" required>
                        </div>
                        <div class="col-md-6">
                            <label for="editCedulaUsuario" class="form-label">ID / C√©dula</label>
                            <input type="text" class="form-control" id="editCedulaUsuario" readonly> 
                        </div>
                    </div>

                    <h6 class="mb-3 text-primary">Datos de Contacto y Acceso</h6>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="editEmailUsuario" class="form-label">Email</label>
                            <input type="email" class="form-control" id="editEmailUsuario" required>
                        </div>
                        <div class="col-md-6">
                            <label for="editTelefonoUsuario" class="form-label">Tel√©fono</label>
                            <input type="tel" class="form-control" id="editTelefonoUsuario">
                        </div>
                    </div>

                    <h6 class="mb-3 text-primary">Asignaci√≥n de Rol</h6>
                    <div class="row mb-3">
                        <div class="col-md-12">
                            <label for="editRolUsuario" class="form-label">Rol</label>
                            <select class="form-select" id="editRolUsuario" required>
                                <option value="paciente">Paciente</option>
                                <option value="medico">M√©dico</option>
                                <option value="admin">Administrador</option>
                            </select>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-success"><i class="fas fa-check me-2"></i> Guardar Cambios</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function restablecerContrasena(userId) {
        // Paso 1: Confirmaci√≥n de Seguridad
        const confirmar = confirm(`¬øEst√°s seguro de que deseas restablecer la contrase√±a para el usuario con ID: ${userId}? Esto generar√° una nueva clave.`);

        if (confirmar) {
            // Si el administrador confirma, se simula el proceso de seguridad.
            
            // üö® Aqu√≠ ir√≠a el c√≥digo AJAX (As√≠ncrono) üö®
            // que llama a tu servidor (backend) para:
            // 1. Generar la nueva contrase√±a.
            // 2. Encriptarla y guardarla en la base de datos.
            // 3. Enviar un correo de notificaci√≥n al usuario.
            
            // --- SIMULACI√ìN (Reemplazar con c√≥digo real del servidor) ---
            
            // Simulamos una demora de 1.5 segundos para la respuesta del servidor
            setTimeout(() => {
                // Paso 4: Retroalimentaci√≥n Visual de √âxito
                alert(`¬°√âxito! La contrase√±a del usuario ${userId} ha sido restablecida. Se ha enviado una notificaci√≥n al correo electr√≥nico del usuario.`);
                // Opcionalmente, podr√≠as cambiar el contenido de la celda '√öltimo Acceso'
            }, 1500);
            
            // --- FIN DE LA SIMULACI√ìN ---
            
        } else {
            // Si el administrador cancela.
            console.log(`Restablecimiento de contrase√±a cancelado para el usuario ${userId}.`);
        }
    }
</script>
</body>
</html>